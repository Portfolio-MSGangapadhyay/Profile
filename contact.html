<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>M. S. Gangapadhyay</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Playfair+Display:,300, 400, 700"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="css/bootstrap.css" />
    <link rel="stylesheet" href="css/animate.css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/mediaelement@4.2.7/build/mediaelementplayer.min.css"
    />

    <link rel="stylesheet" href="fonts/ionicons/css/ionicons.min.css" />
    <link rel="stylesheet" href="fonts/fontawesome/css/font-awesome.min.css" />

    <!-- Theme Style -->
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="site-wrap">
      <a href="#" class="offcanvas-toggle js-offcanvas-toggle">Menu</a>
      <div class="offcanvas_menu" id="offcanvas_menu">
        <ul class="mb-5">
          <li><a href="index.html">Bio</a></li>
          <!-- <li><a href="portfolio.html">Portfolio</a></li> -->
          <li><a href="resume.html">Resume</a></li>
          <li class="active"><a href="contact.html">Contact</a></li>
        </ul>
        <ul class="social">
          <li><a href="#" class="fa fa-linkedin"></a></li>
          <li><a href="#" class="fa fa-facebook"></a></li>
          <li><a href="#" class="fa fa-whatsapp"></a></li>
        </ul>
      </div>

      <aside style="background-image: url(img/profile_big.jpg);"></aside>
      <main>
        <h1 class="mb-5">Contact Me</h1>
        <form name="submit-to-google-sheet">
          <div class="row mb-4">
            <div class="col-md-12">
              <input
                type="text"
                class="form-control"
                name="name"
                placeholder="Full Name"
              />
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-md-12">
              <input
                type="text"
                class="form-control"
                name="email"
                placeholder="Email Address"
              />
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-md-12">
              <input
                type="text"
                class="form-control"
                placeholder="Phone"
                name="phone"
              />
            </div>
          </div>
          <div class="row mb-4">
            <div class="col-md-12">
              <textarea
                name="comment"
                id=""
                class="form-control"
                placeholder="Contact/Comment"
                cols="30"
                rows="10"
              ></textarea>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <input
                type="submit"
                class="btn btn-primary btn-block"
                value="Send Message"
              />
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div
                id="Response-Submit"
                style="font-size: 18px; color: #f73859; margin-top: 20px;"
              ></div>
            </div>
          </div>
        </form>
      </main>
    </div>

    <!-- loader -->
    <div id="loader" class="show fullscreen">
      <svg class="circular" width="48px" height="48px">
        <circle
          class="path-bg"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke="#eeeeee"
        />
        <circle
          class="path"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke-miterlimit="10"
          stroke="#f4b214"
        />
      </svg>
    </div>

    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.countdown.min.js"></script>
    <script src="js/main.js"></script>
  </body>
  <script>
    var message_area = document.getElementById("Response-Submit");
    function messageHandler() {
      message_area.innerHTML = "Response Submitted Successfully";
      setTimeout(function () {
        message_area.textContent = "";
      }, 3500);
    }
    function errorHandler() {
      message_area.innerHTML = "Error Submitting Response. Try again later.";
      setTimeout(function () {
        message_area.textContent = "";
      }, 3500);
    }
    const scriptURL =
      "https://script.google.com/macros/s/AKfycbz7hqktJNS5C11utyPoKY473zm-7RJACehX-DZPk7GR1wGANSE/exec";
    const form = document.forms["submit-to-google-sheet"];
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      message_area.innerHTML = "Submitted. Waiting ....";
      fetch(scriptURL, {
        mode: "no-cors",
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: new FormData(form),
      })
        .then((response) => messageHandler())
        .catch((response) => errorHandler());
    });
  </script>
</html>
